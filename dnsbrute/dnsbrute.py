import sys

import dns.resolver

r = dns.resolver.Resolver()

def dnsbrute(target, wordlist):
    try:
        with open(wordlist, "r") as f:
            subdomains = f.readlines()
            for subdomain in subdomains:
                try:
                    target_dns = "{}.{}".format(subdomain.strip(), target)
                    results = r.resolve(target_dns, "A")
                    for result in results:
                        print("[ + ] url: {} ==> ip: {}".format(target_dns, result))
                except:
                    pass
    except FileNotFoundError:
        print("File not found.")
        sys.exit(0)
    except KeyboardInterrupt:
        print("Keyboard Interrupt.")
        sys.exit(0)
    except Exception:
        print("Unexpected error as occured.")
        sys.exit(0)

if __name__ == "__main__":
    if len(sys.argv) <= 2:
        print("===============================")
        print("##          DNS Brute        ##")
        print("===============================")
        print("")
        print("Use: python dnsbrute.py <url> <file.txt>")
        sys.exit(0)
wordlist = sys.argv[2]
target = sys.argv[1]
dnsbrute(target, wordlist)
